<p>As every web-developer knows, testing your Web pages on the myriad of popular Web browsers can often be a horrible experience&#8230;and if there&#8217;s one thing which is even worse than testing web pages in different browsers, it surely has to be testing HTML Email layout in multiple Email clients!</p>
<p><strong>Please note: In this article, I am only covering desktop/dedicated Email clients such as Outlook/Thunderbird/Apple Mail etc rather than Web-browser-based Email clients such as Hotmail/GMail/Yahoo! Mail etc.</strong></p>
<p>HTML Emails are something I deal with more and more on a day-to-day basis so I thought I&#8217;d make an effort to share some of the things I&#8217;ve learned in the hope that it may save someone some time and effort. This article may well end up being revised quite a lot over time but here goes:</p>
<p><strong>First thing&#8217;s first! Rendering engines&#8230;<br />
</strong>In the same way as Web browsers have rendering engines to transform the HTML, CSS, JavaScript etc into something viewable and usable (hopefully), Email clients have a rendering engine to do the same job for HTML-based Emails. At first, it might seem like a total nightmare to test on multiple Email clients, particularly given the horrific offerings produced over the years by Microsoft (Outlook) and IBM (Lotus notes) amongst others but there are some important facts which can help you a lot in both testing and bug-tracing.</p>
<p>Firstly, there are only really 4 rendering engines used in major Email clients (there should only be 3 but we&#8217;ll get to that later!):</p>
<ol>
<li>Gecko &#8211; The same rendering Engine used in Mozilla Firefox web browser, this is used primarily in Mozilla Thunderbird</li>
<li>Webkit &#8211; The same rendering Engine used in Apple&#8217;s Safari web browser, this is used primarily in Apple Mail including IPhone OS and IOS4 Mail apps on IPhone/IPad/IPod</li>
<li>Trident &#8211; The same rendering Engine used in Microsoft&#8217;s Internet Explorer web browser, this is  used primarily in Microsoft Outlook until (but not including) Outlook 2007 and IBM&#8217;s Lotus notes</li>
<li>MS Word &#8211; The same rendering Engine used in Microsoft Office Word, this is  used primarily in Outlook 2007 and 2010</li>
</ol>
<p>So, this is good news&#8230;to an extent. Gecko and Webkit are pretty good in terms of standards support, if you write good (X)HTML and CSS, your Email is likely to display as you intend it to in Gecko and Webkit based Email clients such as Mozilla Thunderbird and Apple Mail respectively.</p>
<p>Things become a little more complex with Outlook and Lotus notes which between the two of them, still dominate. It works like this:</p>
<p>Outlook versions before 2007 use the Trident rendering engine which is used in Internet Explorer. Crucially, <strong>Outlook uses the version of Trident which is currently installed with Internet Explorer on your PC</strong>. So, if you have for example, Outlook 2000 running on Windows XP but you have upgraded to Internet Explorer 8, Outlook 2000 will render Email with the version of Trident which was installed with Internet Explorer 8 even though Internet Explorer 8 didn&#8217;t exist when Outlook 2000 was released. This is well worth knowing if you&#8217;re trying to trace problems!</p>
<p>Outlook 2007 &amp; 2010 for some inexplicable reason, use the rendering engine found in Microsoft Word&#8230;that is not a typo! Yes, Microsoft chose the lazy route&#8230;again.<br />
Actually, when we look at a little more detail, Outlook versions prior to 2007 used the Trident rendering engine to display Email but the MS Word rendering engine to compose Email (presumably because Word is more akin to a compose window than Trident). So, with Outlook 2007 &amp; 2010, Microsoft have unified the rendering engine used in Outlook which is a good move, however they clearly took the easiest route and have consequently landed developers with yet another Redmond-fuelled nightmare!</p>
<p><strong>Why is the Microsoft Word rendering engine bad news?</strong><br />
Well, there are a great many reasons which the MS Word rendering engine should not have been used in Outlook 2007 &amp; 2010, perhaps the most fundamental to developers is that <strong>background images are not supported by Outlook 2007 or Outlook 2010 </strong>on at least div&#8217;s and table cells! Absolutely shocking and incredibly restrictive. This is a major, major problem.</p>
<p>The MS Word rendering engine in Outlook 2007 &amp; 2010 also has no support for CSS float or position, extremely patchy support for CSS padding and margin, problems with nested elements background colours and even patchy support for CSS width and height &#8211; incredible. I have also found some problems whereby Outlook 2007 &amp; 2010 do not override stylesheet CSS with inline CSS which is just bizarre&#8230;</p>
<p>I&#8217;ll update this article as I find more information and no doubt more bugs. This didn&#8217;t start out with the intention of Microsoft bashing but the more I&#8217;ve written the more annoyed I am with them&#8230;If only everyone could &amp; would download something else!</p>
<p>Further reading:</p>
<ul>
<li>A more complete report of what&#8217;s working and what&#8217;s broken in Outlook 2007 from Email Standards Org: <a href="http://www.email-standards.org/clients/microsoft-outlook-2007/" target="_blank">http://www.email-standards.org/clients/microsoft-outlook-2007/</a></li>
<li>Microsoft&#8217;s Outlook 2007 rendering engine notes: <a href="http://msdn.microsoft.com/en-us/library/aa338201%28office.12%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/aa338201%28office.12%29.aspx</a></li>
<li>A comparison of Email clients on Wikipedia: <a href="http://en.wikipedia.org/wiki/Comparison_of_email_clients" target="_blank">http://en.wikipedia.org/wiki/Comparison_of_email_clients</a></li>
<li>A comparison of layout engines on Wikipedia: <a href="http://en.wikipedia.org/wiki/Comparison_of_layout_engines" target="_blank">http://en.wikipedia.org/wiki/Comparison_of_layout_engines</a></li>
</ul>